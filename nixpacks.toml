# Railway NIXPACKS configuration
# IMPORTANT: Root Directory in Railway must be set to "backend"
# When Root Directory is "backend", this file should be in backend/nixpacks.toml
# But Railway scans from root first, so we put it here to prevent auto-detection

[providers]
python = "3.11"

[phases.setup]
nixPkgs = ["python311", "pip"]

[phases.install]
# Install from requirements.txt (relative to Root Directory which is backend/)
cmds = ["pip install --upgrade pip", "pip install -r requirements.txt"]

# CRITICAL: Explicitly disable build phase
# Railway's Railpack auto-detects backend/requirements.txt from repo root
# and tries to add: pip install -r backend/requirements.txt
# This fails because Root Directory is backend/, so it looks for backend/backend/requirements.txt
# Setting build phase to empty should prevent this, but Railway might still add it
[phases.build]
cmds = []

[start]
cmd = "uvicorn main:app --host 0.0.0.0 --port $PORT"

